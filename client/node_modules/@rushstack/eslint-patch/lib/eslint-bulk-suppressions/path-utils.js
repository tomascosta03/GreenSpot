"use strict";
// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.
// See LICENSE in the project root for license information.
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
<<<<<<< HEAD
exports.ensurePathToGeneratedPatch = exports.getPathToLinterJS = exports.findAndConsoleLogPatchPathCli = void 0;
const fs_1 = __importDefault(require("fs"));
const os_1 = __importDefault(require("os"));
const _patch_base_1 = require("../_patch-base");
const constants_1 = require("./constants");
const package_json_1 = __importDefault(require("../../package.json"));
const CURRENT_PACKAGE_VERSION = package_json_1.default.version;
function findAndConsoleLogPatchPathCli() {
    const eslintBulkDetectEnvVarValue = process.env[constants_1.ESLINT_BULK_DETECT_ENV_VAR_NAME];
    if (eslintBulkDetectEnvVarValue !== 'true' && eslintBulkDetectEnvVarValue !== '1') {
=======
exports.getNameOfGeneratedPatchFile = exports.getPathToGeneratedPatch = exports.getPathToLinterJS = exports.findAndConsoleLogPatchPathCli = void 0;
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const _patch_base_1 = require("../_patch-base");
function findAndConsoleLogPatchPathCli(patchPath) {
    if (process.env._RUSHSTACK_ESLINT_BULK_DETECT !== 'true') {
>>>>>>> 58a898f60b5c2e97f0cba20a4b73900a14201cd7
        return;
    }
    const startDelimiter = 'RUSHSTACK_ESLINT_BULK_START';
    const endDelimiter = 'RUSHSTACK_ESLINT_BULK_END';
    const configuration = {
        /**
<<<<<<< HEAD
         * `@rushstack/eslint-bulk` should report an error if its package.json is older than this number
         */
        minCliVersion: '0.0.0',
        /**
         * `@rushstack/eslint-bulk` will invoke this entry point
         */
        cliEntryPoint: require.resolve('../exports/eslint-bulk')
=======
         * `@rushtack/eslint`-bulk should report an error if its package.json is older than this number
         */
        minCliVersion: '0.0.0',
        /**
         * `@rushtack/eslint-bulk` will invoke this entry point
         */
        cliEntryPoint: path_1.default.resolve(patchPath, '..', 'exports', 'eslint-bulk.js')
>>>>>>> 58a898f60b5c2e97f0cba20a4b73900a14201cd7
    };
    console.log(startDelimiter + JSON.stringify(configuration) + endDelimiter);
}
exports.findAndConsoleLogPatchPathCli = findAndConsoleLogPatchPathCli;
function getPathToLinterJS() {
    if (!_patch_base_1.eslintFolder) {
        throw new Error('Cannot find ESLint installation to patch.');
    }
<<<<<<< HEAD
    return `${_patch_base_1.eslintFolder}/lib/linter/linter.js`;
}
exports.getPathToLinterJS = getPathToLinterJS;
function ensurePathToGeneratedPatch() {
    const patchesFolderPath = `${os_1.default.tmpdir()}/rushstack-eslint-bulk-${CURRENT_PACKAGE_VERSION}/patches`;
    fs_1.default.mkdirSync(patchesFolderPath, { recursive: true });
    const pathToGeneratedPatch = `${patchesFolderPath}/linter-patch-v${_patch_base_1.eslintPackageVersion}.js`;
    return pathToGeneratedPatch;
}
exports.ensurePathToGeneratedPatch = ensurePathToGeneratedPatch;
=======
    return path_1.default.join(_patch_base_1.eslintFolder, 'lib', 'linter', 'linter.js');
}
exports.getPathToLinterJS = getPathToLinterJS;
function getPathToGeneratedPatch(patchPath, nameOfGeneratedPatchFile) {
    fs_1.default.mkdirSync(path_1.default.join(patchPath, 'temp', 'patches'), { recursive: true });
    const pathToGeneratedPatch = path_1.default.join(patchPath, 'temp', 'patches', nameOfGeneratedPatchFile);
    return pathToGeneratedPatch;
}
exports.getPathToGeneratedPatch = getPathToGeneratedPatch;
function getEslintPackageVersion() {
    if (!_patch_base_1.eslintFolder) {
        throw new Error('Cannot find ESLint installation to patch.');
    }
    const eslintPackageJsonPath = path_1.default.join(_patch_base_1.eslintFolder, 'package.json');
    const eslintPackageJson = fs_1.default.readFileSync(eslintPackageJsonPath).toString();
    const eslintPackageObject = JSON.parse(eslintPackageJson);
    const eslintPackageVersion = eslintPackageObject.version;
    return eslintPackageVersion;
}
function getNameOfGeneratedPatchFile() {
    const eslintPackageVersion = getEslintPackageVersion();
    const nameOfGeneratedPatchFile = `linter-patch-v${eslintPackageVersion}.js`;
    return nameOfGeneratedPatchFile;
}
exports.getNameOfGeneratedPatchFile = getNameOfGeneratedPatchFile;
>>>>>>> 58a898f60b5c2e97f0cba20a4b73900a14201cd7
//# sourceMappingURL=path-utils.js.map